<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to analyse, understand, and communicate about your data!">
<title>Big Data &amp; Data Visualisation - A whole game</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//files/favicon-512.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta property="og:title" content="Big Data &amp; Data Visualisation - A whole game">
<meta property="og:description" content="">
<meta property="og:image" content="https://marcellgranat.com/bigdata/files/social-image-s23.png">
<meta property="og:site-name" content="Big Data &amp; Data Visualisation">
<meta property="og:locale" content="en_US">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Big Data &amp; Data Visualisation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../content/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Classes and readings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignment.html" rel="" target="">
 <span class="menu-text">Assignments</span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/03-content.html">Data manipulation I</a></li><li class="breadcrumb-item"><a href="../content/04-content.html">A whole game</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Readings, lectures, and videos</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/01-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/02-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics in R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Data manipulation I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/03-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/04-content.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">A whole game</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Data manipulation II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/05-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regex</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/06-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functional programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/07-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A whole game</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Regression, classification</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/08-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Data Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/09-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/10-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced ggplot2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Casual Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/11-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Casual Inference</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Web scraping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/12-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web scraping</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Clustering, Dimension Reduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/13-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/14-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PCA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">ML</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/15-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithmic Modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/16-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidy modelling</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true">
 <span class="menu-text">Data bases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/17-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Data bases</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
 <span class="menu-text">Text mining</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/18-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to text mining</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7">A whole game</h1>

<div class="date-block bg-class text-white p-2">
  <p class="date">Readings and class materials for Tuesday, September 19, 2023</p>
</div>
</header><p>You can access an Excel spreadsheet on infant mortality downloaded from Eurostat. We discovered last week that utilizing the Eurostat data is significantly facilitated by the <code>eurostat</code> package; however, for the purpose of practical demonstration, we now need to showcase the multitude of cleaning procedures required to establish links between series originating from diverse sources.</p>
<p><img src="images/CleanShot 2023-09-18 at 16.19.59@2x.png" class="img-fluid"></p>
<p>Lets download the <a href="https://appsso.eurostat.ec.europa.eu/nui/submitViewTableAction.do">infant mortality rates from Eurostat</a> (in Excel format) and link it with the <code>fertility_df</code></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"../data/demo_minfind.xls"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The issue here is that there are multiple tables on the first sheet (not a rare thing).</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 339 × 62
   Infant mortality rate…¹ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10
   &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 &lt;NA&gt;                    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 2 Last update             4474… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 3 Extracted on            4482… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 4 Source of data          Euro… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 5 &lt;NA&gt;                    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 6 INDIC_DE                Earl… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 7 UNIT                    Rate  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 8 &lt;NA&gt;                    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 9 GEO/TIME                1960  1961  1962  1963  1964  1965  1966  1967  1968 
10 European Union - 27 co… :     :     :     :     :     :     :     :     :    
# ℹ 329 more rows
# ℹ abbreviated name: ¹​`Infant mortality rates [demo_minfind]`
# ℹ 52 more variables: ...11 &lt;chr&gt;, ...12 &lt;chr&gt;, ...13 &lt;chr&gt;, ...14 &lt;chr&gt;,
#   ...15 &lt;chr&gt;, ...16 &lt;chr&gt;, ...17 &lt;chr&gt;, ...18 &lt;chr&gt;, ...19 &lt;chr&gt;,
#   ...20 &lt;chr&gt;, ...21 &lt;chr&gt;, ...22 &lt;chr&gt;, ...23 &lt;chr&gt;, ...24 &lt;chr&gt;,
#   ...25 &lt;chr&gt;, ...26 &lt;chr&gt;, ...27 &lt;chr&gt;, ...28 &lt;chr&gt;, ...29 &lt;chr&gt;,
#   ...30 &lt;chr&gt;, ...31 &lt;chr&gt;, ...32 &lt;chr&gt;, ...33 &lt;chr&gt;, ...34 &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>After exploring the data, you may realize that the name of the data is always in the second column. Our table starts after where find the “Infant mortality rate”.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pull</span><span class="op">(</span><span class="va">infant_mortality_df</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># 2nd column as vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] NA                              "44742.521828703699"           
  [3] "44822.86385927083"             "Eurostat"                     
  [5] NA                              "Early neonatal mortality rate"
  [7] "Rate"                          NA                             
  [9] "1960"                          ":"                            
 [11] ":"                             ":"                            
 [13] ":"                             ":"                            
 [15] "17.100000000000001"            "10.9"                         
 [17] "10.699999999999999"            "13.9"                         
 [19] "20.800000000000001"            "19.699999999999999"           
 [21] "9.5999999999999996"            "16.100000000000001"           
 [23] "12.300000000000001"            "15.9"                         
 [25] ":"                             "14.6"                         
 [27] "21"                            "17.800000000000001"           
 [29] ":"                             ":"                            
 [31] "7.2999999999999998"            "16.300000000000001"           
 [33] "22.100000000000001"            ":"                            
 [35] "11.9"                          "20.199999999999999"           
 [37] ":"                             "15"                           
 [39] ":"                             "15.6"                         
 [41] "10.300000000000001"            "12.6"                         
 [43] "11.800000000000001"            ":"                            
 [45] ":"                             ":"                            
 [47] ":"                             "7.0999999999999996"           
 [49] ":"                             "9.9000000000000004"           
 [51] "14.4"                          "13.699999999999999"           
 [53] ":"                             "18.600000000000001"           
 [55] ":"                             ":"                            
 [57] ":"                             ":"                            
 [59] ":"                             "17.300000000000001"           
 [61] ":"                             ":"                            
 [63] ":"                             ":"                            
 [65] ":"                             ":"                            
 [67] ":"                             ":"                            
 [69] NA                              NA                             
 [71] "not available"                 NA                             
 [73] "Infant mortality rate"         "Rate"                         
 [75] NA                              "1960"                         
 [77] ":"                             ":"                            
 [79] ":"                             ":"                            
 [81] ":"                             "31.399999999999999"           
 [83] "45.100000000000001"            "20"                           
 [85] "21.5"                          "33.799999999999997"           
 [87] "35"                            "31.100000000000001"           
 [89] "29.300000000000001"            "40.100000000000001"           
 [91] "35.399999999999999"            ":"                            
 [93] "27.699999999999999"            "70.400000000000006"           
 [95] "43.899999999999999"            ":"                            
 [97] "27"                            "38"                           
 [99] "31.5"                          "47.600000000000001"           
[101] "38.299999999999997"            "16.5"                         
[103] "37.5"                          "56.100000000000001"           
[105] "77.5"                          "75.700000000000003"           
[107] "35.100000000000001"            "28.600000000000001"           
[109] "21"                            "16.600000000000001"           
[111] ":"                             ":"                            
[113] ":"                             "18.899999999999999"           
[115] "13"                            "21.100000000000001"           
[117] "16"                            "21.100000000000001"           
[119] "22.5"                          ":"                            
[121] "114.59999999999999"            "83"                           
[123] ":"                             ":"                            
[125] ":"                             ":"                            
[127] "107"                           "132.5"                        
[129] ":"                             ":"                            
[131] ":"                             ":"                            
[133] ":"                             ":"                            
[135] ":"                             NA                             
[137] NA                              "not available"                
[139] NA                              "Late foetal mortality rate"   
[141] "Rate"                          NA                             
[143] "1960"                          ":"                            
[145] ":"                             ":"                            
[147] ":"                             ":"                            
[149] "15.300000000000001"            "12.199999999999999"           
[151] "9.8000000000000007"            "12.4"                         
[153] "15.300000000000001"            "15.5"                         
[155] "13"                            "21.899999999999999"           
[157] "14.300000000000001"            "27.300000000000001"           
[159] ":"                             "17"                           
[161] "12.4"                          "24.5"                         
[163] ":"                             "10.699999999999999"           
[165] "8.9000000000000004"            "16.100000000000001"           
[167] "13.199999999999999"            ":"                            
[169] "14.9"                          "15"                           
[171] "12.5"                          "26.5"                         
[173] "15.9"                          "14.199999999999999"           
[175] "10.9"                          "15.1"                         
[177] "13.699999999999999"            ":"                            
[179] ":"                             ":"                            
[181] "12.4"                          "12.699999999999999"           
[183] "10.4"                          "13.9"                         
[185] "11.4"                          "20.100000000000001"           
[187] ":"                             "9.8000000000000007"           
[189] ":"                             ":"                            
[191] ":"                             ":"                            
[193] ":"                             "8.6999999999999993"           
[195] ":"                             ":"                            
[197] ":"                             ":"                            
[199] ":"                             ":"                            
[201] ":"                             ":"                            
[203] NA                              NA                             
[205] "not available"                 NA                             
[207] "Neonatal mortality rate"       "Rate"                         
[209] NA                              "1960"                         
[211] ":"                             ":"                            
[213] ":"                             ":"                            
[215] ":"                             "20.5"                         
[217] "19.399999999999999"            "13.1"                         
[219] "16.100000000000001"            "23.899999999999999"           
[221] "23.199999999999999"            ":"                            
[223] "20.399999999999999"            "19.5"                         
[225] "20.199999999999999"            ":"                            
[227] "17.699999999999999"            "35.100000000000001"           
[229] "23.899999999999999"            ":"                            
[231] "10.9"                          "13.4"                         
[233] "19.100000000000001"            "27"                           
[235] ":"                             "13.5"                         
[237] "24.600000000000001"            ":"                            
[239] "27.899999999999999"            ":"                            
[241] "20.399999999999999"            "14.1"                         
[243] "14.4"                          "13.4"                         
[245] ":"                             ":"                            
[247] ":"                             ":"                            
[249] "9.1999999999999993"            ":"                            
[251] "11.699999999999999"            "16.100000000000001"           
[253] "16"                            ":"                            
[255] "41.399999999999999"            ":"                            
[257] ":"                             ":"                            
[259] ":"                             ":"                            
[261] "32.799999999999997"            ":"                            
[263] ":"                             ":"                            
[265] ":"                             ":"                            
[267] ":"                             ":"                            
[269] ":"                             NA                             
[271] NA                              "not available"                
[273] NA                              "Perinatal mortality rate"     
[275] "Rate"                          NA                             
[277] "1960"                          ":"                            
[279] ":"                             ":"                            
[281] ":"                             ":"                            
[283] "32.100000000000001"            "23"                           
[285] "20.5"                          "26.199999999999999"           
[287] "35.799999999999997"            "34.899999999999999"           
[289] "22.5"                          "37.700000000000003"           
[291] "26.399999999999999"            "42.799999999999997"           
[293] ":"                             "31.399999999999999"           
[295] "33.100000000000001"            "41.899999999999999"           
[297] ":"                             ":"                            
[299] "16.100000000000001"            "32.200000000000003"           
[301] "35"                            ":"                            
[303] "26.600000000000001"            "34.899999999999999"           
[305] ":"                             "41.100000000000001"           
[307] ":"                             "29.600000000000001"           
[309] "21"                            "27.5"                         
[311] "25.399999999999999"            ":"                            
[313] ":"                             ":"                            
[315] ":"                             "19.699999999999999"           
[317] ":"                             "23.699999999999999"           
[319] "25.600000000000001"            "33.5"                         
[321] ":"                             "28.199999999999999"           
[323] ":"                             ":"                            
[325] ":"                             ":"                            
[327] ":"                             "25.800000000000001"           
[329] ":"                             ":"                            
[331] ":"                             ":"                            
[333] ":"                             ":"                            
[335] ":"                             ":"                            
[337] NA                              NA                             
[339] "not available"                </code></pre>
</div>
</div>
<p>After exploring the data, you may realise that the name of the data is always in the second column. Our data starts where find we the “Infant mortality rate”. The first row of the table where we find “GEO/TIME” in the first column</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_start_index</span> <span class="op">&lt;-</span> <span class="fu">pull</span><span class="op">(</span><span class="va">infant_mortality_df</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/detect.html">detect_index</a></span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">==</span> <span class="st">"Infant mortality rate"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_start_index</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start_index</span> <span class="op">&lt;-</span> <span class="fu">pull</span><span class="op">(</span><span class="va">infant_mortality_df</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="op">{</span><span class="va">.</span> <span class="op">==</span> <span class="st">"GEO/TIME"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">}</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">detect</span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">&gt;</span> <span class="va">data_start_index</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And ends at the next empty cell (not “:”)</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">end_index</span> <span class="op">&lt;-</span> <span class="fu">pull</span><span class="op">(</span><span class="va">infant_mortality_df</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">detect</span><span class="op">(</span><span class="op">~</span> <span class="va">.</span> <span class="op">&gt;</span> <span class="va">start_index</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 61 × 62
   Infant mortality rate…¹ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10
   &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 GEO/TIME                1960  1961  1962  1963  1964  1965  1966  1967  1968 
 2 European Union - 27 co… :     38.2… 36.3… 34.2… 31.8… 30    29.1… 28.6… 29.1…
 3 European Union - 28 co… :     36.2… 34.6… 32.7… 30.5  28.6… 28    27.5  27.8…
 4 European Union - 27 co… :     36    34.3… 32.5  30.3… 28.5  27.8… 27.3… 27.8…
 5 Euro area - 19 countri… :     34.7… 33.2… 31.8… 29.6… 28.3… 27.6… 26.1… 25.6…
 6 Euro area - 18 countri… :     34.7… 33.2… 31.8… 29.6… 28.3… 27.6… 26.1… 25.6…
 7 Belgium                 31.3… 28.1… 27.5  27.1… 25.3… 23.6… 24.6… 22.8… 21.6…
 8 Bulgaria                45.1… 37.7… 37.2… 35.7… 32.8… 30.8… 32.2… 33.1… 28.3…
 9 Czechia                 20    19.3… 21.1… 19.6… 19.1… 23.6… 21.8… 21.5  21.6…
10 Denmark                 21.5  21.8… 20.1… 19.1… 18.6… 18.6… 16.8… 15.8… 16.3…
# ℹ 51 more rows
# ℹ abbreviated name: ¹​`Infant mortality rates [demo_minfind]`
# ℹ 52 more variables: ...11 &lt;chr&gt;, ...12 &lt;chr&gt;, ...13 &lt;chr&gt;, ...14 &lt;chr&gt;,
#   ...15 &lt;chr&gt;, ...16 &lt;chr&gt;, ...17 &lt;chr&gt;, ...18 &lt;chr&gt;, ...19 &lt;chr&gt;,
#   ...20 &lt;chr&gt;, ...21 &lt;chr&gt;, ...22 &lt;chr&gt;, ...23 &lt;chr&gt;, ...24 &lt;chr&gt;,
#   ...25 &lt;chr&gt;, ...26 &lt;chr&gt;, ...27 &lt;chr&gt;, ...28 &lt;chr&gt;, ...29 &lt;chr&gt;,
#   ...30 &lt;chr&gt;, ...31 &lt;chr&gt;, ...32 &lt;chr&gt;, ...33 &lt;chr&gt;, ...34 &lt;chr&gt;, …</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the colnames are not tidy or they are threated as observation, then use the <a href="https://github.com/sfirke/janitor">janitor</a> package.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 62
   `GEO/TIME`     `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967` `1968`
   &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; 
 1 European Unio… :      38.20… 36.39… 34.29… 31.89… 30     29.19… 28.69… 29.19…
 2 European Unio… :      36.20… 34.60… 32.70… 30.5   28.69… 28     27.5   27.89…
 3 European Unio… :      36     34.39… 32.5   30.30… 28.5   27.80… 27.39… 27.80…
 4 Euro area - 1… :      34.79… 33.29… 31.80… 29.60… 28.30… 27.60… 26.19… 25.69…
 5 Euro area - 1… :      34.79… 33.20… 31.80… 29.60… 28.30… 27.60… 26.19… 25.69…
 6 Belgium        31.39… 28.10… 27.5   27.19… 25.30… 23.69… 24.69… 22.89… 21.69…
 7 Bulgaria       45.10… 37.79… 37.29… 35.70… 32.89… 30.80… 32.20… 33.10… 28.30…
 8 Czechia        20     19.30… 21.10… 19.69… 19.10… 23.69… 21.89… 21.5   21.60…
 9 Denmark        21.5   21.80… 20.10… 19.10… 18.69… 18.69… 16.89… 15.80… 16.39…
10 Germany (unti… 33.79… 31.69… 29.30… 27     25.30… 23.89… 23.60… 22.89… 22.80…
# ℹ 50 more rows
# ℹ 52 more variables: `1969` &lt;chr&gt;, `1970` &lt;chr&gt;, `1971` &lt;chr&gt;, `1972` &lt;chr&gt;,
#   `1973` &lt;chr&gt;, `1974` &lt;chr&gt;, `1975` &lt;chr&gt;, `1976` &lt;chr&gt;, `1977` &lt;chr&gt;,
#   `1978` &lt;chr&gt;, `1979` &lt;chr&gt;, `1980` &lt;chr&gt;, `1981` &lt;chr&gt;, `1982` &lt;chr&gt;,
#   `1983` &lt;chr&gt;, `1984` &lt;chr&gt;, `1985` &lt;chr&gt;, `1986` &lt;chr&gt;, `1987` &lt;chr&gt;,
#   `1988` &lt;chr&gt;, `1989` &lt;chr&gt;, `1990` &lt;chr&gt;, `1991` &lt;chr&gt;, `1992` &lt;chr&gt;,
#   `1993` &lt;chr&gt;, `1994` &lt;chr&gt;, `1995` &lt;chr&gt;, `1996` &lt;chr&gt;, `1997` &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Next issue: All columns are in character format</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>infant_mortality_df <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(start_index<span class="sc">:</span>end_index) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="er">*</span> <span class="fu">mutate_at</span>(<span class="sc">-</span> <span class="dv">1</span>, as.numeric) <span class="co"># all except the 1st col</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 62
   `GEO/TIME`     `1960` `1961` `1962` `1963` `1964` `1965` `1966` `1967` `1968`
   &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 European Unio…   NA     38.2   36.4   34.3   31.9   30     29.2   28.7   29.2
 2 European Unio…   NA     36.2   34.6   32.7   30.5   28.7   28     27.5   27.9
 3 European Unio…   NA     36     34.4   32.5   30.3   28.5   27.8   27.4   27.8
 4 Euro area - 1…   NA     34.8   33.3   31.8   29.6   28.3   27.6   26.2   25.7
 5 Euro area - 1…   NA     34.8   33.2   31.8   29.6   28.3   27.6   26.2   25.7
 6 Belgium          31.4   28.1   27.5   27.2   25.3   23.7   24.7   22.9   21.7
 7 Bulgaria         45.1   37.8   37.3   35.7   32.9   30.8   32.2   33.1   28.3
 8 Czechia          20     19.3   21.1   19.7   19.1   23.7   21.9   21.5   21.6
 9 Denmark          21.5   21.8   20.1   19.1   18.7   18.7   16.9   15.8   16.4
10 Germany (unti…   33.8   31.7   29.3   27     25.3   23.9   23.6   22.9   22.8
# ℹ 50 more rows
# ℹ 52 more variables: `1969` &lt;dbl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;, `1972` &lt;dbl&gt;,
#   `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;,
#   `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;,
#   `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;,
#   `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;,
#   `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>And now lets transform it into long format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>infant_mortality_df <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(start_index<span class="sc">:</span>end_index) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">row_to_names</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="sc">-</span> <span class="dv">1</span>, as.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="er">*</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span> <span class="dv">1</span>, <span class="at">names_to =</span> <span class="st">"TIME"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"infant_mortality"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,660 × 3
   `GEO/TIME`                                TIME  infant_mortality
   &lt;chr&gt;                                     &lt;chr&gt;            &lt;dbl&gt;
 1 European Union - 27 countries (from 2020) 1960              NA  
 2 European Union - 27 countries (from 2020) 1961              38.2
 3 European Union - 27 countries (from 2020) 1962              36.4
 4 European Union - 27 countries (from 2020) 1963              34.3
 5 European Union - 27 countries (from 2020) 1964              31.9
 6 European Union - 27 countries (from 2020) 1965              30  
 7 European Union - 27 countries (from 2020) 1966              29.2
 8 European Union - 27 countries (from 2020) 1967              28.7
 9 European Union - 27 countries (from 2020) 1968              29.2
10 European Union - 27 countries (from 2020) 1969              28  
# ℹ 3,650 more rows</code></pre>
</div>
</div>
<p>Lets filter out aggregates and irrelevant.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_at</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"TIME"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"infant_mortality"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>geo <span class="op">=</span> <span class="va">`GEO/TIME`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    geo <span class="op">=</span> <span class="fu">countrycode</span><span class="op">(</span><span class="va">geo</span>, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code filters out the rows where geo is in:</p>
<p><strong>Enough?</strong></p>
<p><code>count()</code> Quickly count the unique values of one or more variables</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_at</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"TIME"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"infant_mortality"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>geo <span class="op">=</span> <span class="va">`GEO/TIME`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    geo <span class="op">=</span> <span class="fu">countrycode</span><span class="op">(</span><span class="va">geo</span>, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">geo</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 47 × 2
   geo       n
   &lt;chr&gt; &lt;int&gt;
 1 DEU     122
 2 FRA     122
 3 ALB      61
 4 AND      61
 5 ARM      61
 6 AUT      61
 7 AZE      61
 8 BEL      61
 9 BGR      61
10 BIH      61
# ℹ 37 more rows</code></pre>
</div>
</div>
<p>Remove the irrelevant duplication &amp; convert <code>TIME</code> to numeric</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_at</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"TIME"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"infant_mortality"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>geo <span class="op">=</span> <span class="va">`GEO/TIME`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">geo</span> <span class="op">!=</span> <span class="st">"France (metropolitan)"</span> <span class="op">&amp;</span></span>
<span>      <span class="va">geo</span> <span class="op">!=</span> <span class="st">"Germany (until 1990 former territory of the FRG)"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">mutate</span><span class="op">(</span></span>
<span>  geo <span class="op">=</span> <span class="fu">countrycode</span><span class="op">(</span><span class="va">geo</span>, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span><span class="op">)</span>,</span>
<span>  TIME <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,867 × 3
   geo    TIME infant_mortality
   &lt;chr&gt; &lt;dbl&gt;            &lt;dbl&gt;
 1 BEL    1960             31.4
 2 BEL    1961             28.1
 3 BEL    1962             27.5
 4 BEL    1963             27.2
 5 BEL    1964             25.3
 6 BEL    1965             23.7
 7 BEL    1966             24.7
 8 BEL    1967             22.9
 9 BEL    1968             21.7
10 BEL    1969             21.2
# ℹ 2,857 more rows</code></pre>
</div>
</div>
<p>Assign it with the same name (re-write the table)</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">infant_mortality_df</span> <span class="op">&lt;-</span> <span class="va">infant_mortality_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html">row_to_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate_at</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span> <span class="fl">1</span>, names_to <span class="op">=</span> <span class="st">"TIME"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"infant_mortality"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>geo <span class="op">=</span> <span class="va">`GEO/TIME`</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">geo</span> <span class="op">!=</span> <span class="st">"France (metropolitan)"</span> <span class="op">&amp;</span></span>
<span>      <span class="va">geo</span> <span class="op">!=</span> <span class="st">"Germany (until 1990 former territory of the FRG)"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">mutate</span><span class="op">(</span></span>
<span>  geo <span class="op">=</span> <span class="fu">countrycode</span><span class="op">(</span><span class="va">geo</span>, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span><span class="op">)</span>,</span>
<span>  TIME <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">TIME</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s transform fertility_df to a similar format</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fertility_df</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://stats.oecd.org/sdmx-json/data/DP_LIVE/.FERTILITY.../OECD?contentType=csv&amp;detail=code&amp;separator=comma&amp;csv-lang=en"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fertility_df</span> <span class="op">&lt;-</span> <span class="va">fertility_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    geo <span class="op">=</span> <span class="va">LOCATION</span>, <span class="va">TIME</span>, fertility <span class="op">=</span> <span class="va">Value</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we need to link the two tables.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span>x <span class="op">=</span> <span class="va">fertility_df</span>, y <span class="op">=</span> <span class="va">infant_mortality_df</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,205 × 4
   geo    TIME fertility infant_mortality
   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;
 1 AUS    1960      3.45               NA
 2 AUS    1961      3.55               NA
 3 AUS    1962      3.43               NA
 4 AUS    1963      3.34               NA
 5 AUS    1964      3.15               NA
 6 AUS    1965      2.97               NA
 7 AUS    1966      2.89               NA
 8 AUS    1967      2.85               NA
 9 AUS    1968      2.89               NA
10 AUS    1969      2.89               NA
# ℹ 4,195 more rows</code></pre>
</div>
</div>
<p>And now… Let’s see what we have here. Last time we saw that we can generate summary statistics with <code>skimr</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">skimr</span><span class="fu">::</span><span class="fu">skim</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">4205</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">geo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">0</td>
</tr></tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TIME</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1990.42</td>
<td style="text-align: right;">17.85</td>
<td style="text-align: right;">1960.00</td>
<td style="text-align: right;">1975.00</td>
<td style="text-align: right;">1990.00</td>
<td style="text-align: right;">2006.00</td>
<td style="text-align: right;">2022.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">fertility</td>
<td style="text-align: right;">911</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">7.67</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">infant_mortality</td>
<td style="text-align: right;">1890</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">14.33</td>
<td style="text-align: right;">15.03</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4.90</td>
<td style="text-align: right;">9.70</td>
<td style="text-align: right;">17.90</td>
<td style="text-align: right;">137.60</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can also generate some pots and statistics easily with the powerful <code>radiant</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">radiant</span><span class="fu">::</span><span class="fu">radiant</span><span class="op">(</span><span class="op">)</span> <span class="co"># start a shiny app on your machine</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But life is never so easy. Let’s suppose we want to visualise only a few countries to tell a story.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">beveridge_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">group</span>, <span class="va">time</span>, <span class="va">n_label</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">time</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">x</span> <span class="op">}</span><span class="op">}</span>, <span class="op">{</span><span class="op">{</span> <span class="va">y</span> <span class="op">}</span><span class="op">}</span>, color <span class="op">=</span> <span class="op">{</span><span class="op">{</span> <span class="va">group</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_path</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="op">~</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">.</span>, <span class="op">{</span><span class="op">{</span> <span class="va">group</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                               <span class="fu">slice</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                                                      length.out <span class="op">=</span> <span class="va">n_label</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="op">{</span><span class="op">{</span> <span class="va">time</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span>,</span>
<span>                             show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                               <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">geo</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SVK"</span>, <span class="st">"HUN"</span>, <span class="st">"AUT"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">beveridge_plot</span><span class="op">(</span><span class="va">fertility</span>, <span class="va">infant_mortality</span>, <span class="va">geo</span>, <span class="va">TIME</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-content_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>



</main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Content <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2023 by <a href="https://www.marcellgranat.com">Marcell Granát</a> <br> All content licensed under a <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>