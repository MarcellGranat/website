<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Learn how to analyse, understand, and communicate about your data!">
<title>Big Data &amp; Data Visualisation - Functional programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//files/favicon-512.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="Big Data &amp; Data Visualisation - Functional programming">
<meta property="og:description" content="">
<meta property="og:image" content="https://marcellgranat.com/bigdata/files/social-image-s23.png">
<meta property="og:site-name" content="Big Data &amp; Data Visualisation">
<meta property="og:locale" content="en_US">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Big Data &amp; Data Visualisation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../content/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Classes and readings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignment.html" rel="" target="">
 <span class="menu-text">Assignments</span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../content/05-content.html">Data manipulation II</a></li><li class="breadcrumb-item"><a href="../content/06-content.html">Functional programming</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Overview</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Readings, lectures, and videos</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/01-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/02-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistics in R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Data manipulation I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/03-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/04-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A whole game</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Data manipulation II</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/05-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regex</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/06-content.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Functional programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/07-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A whole game</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Regression, classification</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/08-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Data Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/09-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/10-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced ggplot2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Casual Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/11-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Casual Inference</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Web scraping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/12-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Web scraping</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Clustering, Dimension Reduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/13-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/14-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PCA</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">ML</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/15-content.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithmic Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/16-content.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidy modeling</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#illustrative-example---load-files" id="toc-illustrative-example---load-files" class="nav-link active" data-scroll-target="#illustrative-example---load-files">Illustrative example - load files</a></li>
  <li><a href="#nested-tibbles" id="toc-nested-tibbles" class="nav-link" data-scroll-target="#nested-tibbles">Nested tibbles</a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">Exercise 1</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2">Exercise 2</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header"><h1 class="title display-7">Functional programming</h1>

<div class="date-block bg-class text-white p-2">
  <p class="date">Readings and class materials for Tuesday, September 26, 2023</p>
</div>
</header><blockquote class="blockquote">
<p>“{purrr} enhances R’s functional programming (FP) toolkit by providing a complete and consistent set of tools for working with functions and vectors. If you’ve never heard of FP before, the best place to start is the family of <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> functions which allow you to <strong>replace many for loops</strong> with code that is both more succinct and easier to read. The best place to learn about the <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> functions is the iteration chapter in <a href="https://r4ds.had.co.nz/iteration.html">R for data science</a>.”</p>
</blockquote>
<p>Source: <a href="https://purrr.tidyverse.org">Package description</a></p>
<p>The purpose of functional programming, as it is written in description of the package, is to implement iterations (recursions) in a readable manner in our code. It is going to be just as a huge advantage of R programming as the dplyr package for tabular data.</p>
<p>The approach is very similar to what we have seen with the <code>apply</code> family, where there is an input object and <strong>we apply the specified function</strong> to each of its elements. This was the <code>lapply</code> function we encountered earlier, as we discussed previously.</p>
<section id="illustrative-example---load-files" class="level3"><h3 class="anchored" data-anchor-id="illustrative-example---load-files">Illustrative example - load files</h3>
<p>Lets suppose we have multiple .csv files in our working directory. These files are generated from the app <a href="https://harzing.com/resources/publish-or-perish">Publish or Perish</a> and contain google search results with different keywords.</p>
<p>The files can be downloaded from <a href="https://codeload.github.com/gist/4ed653c8e655d4ebabaa3071fc7b50a0/zip/5aef770bce91b661744ad8c8b1aed56643f795cf">here</a>. <strong>Copy the zipped files into your working directory.</strong> You can do this without any manual step:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/filea917dfe53d2"</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">"https://codeload.github.com/gist/4ed653c8e655d4ebabaa3071fc7b50a0/zip/5aef770bce91b661744ad8c8b1aed56643f795cf"</span>, destfile <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">td</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi"</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="va">t</span>, junkpaths <span class="op">=</span> <span class="cn">TRUE</span>, exdir <span class="op">=</span> <span class="va">td</span><span class="op">)</span></span>
<span><span class="va">file_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">td</span>, pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">file_names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/daily-inflation-online.csv"         
[2] "/var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/inflation-expectations-forecast.csv"</code></pre>
</div>
</div>
<p>The advantage of this solution is that these files will be placed in a <strong>temporarily created folder</strong> and will be deleted along with the closing of the R session.</p>
<p>Let us recall how we constructed the <code>lapply</code> function call. The input here would be the two file names, and the function to be performed would be the <code>read_csv</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.3     ✔ purrr   1.0.2
✔ tibble  3.2.1     ✔ dplyr   1.1.2
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.4     ✔ forcats 1.0.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 998 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1  3295 GP Compo, JS W… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2   885 E Nakamura, J … High…  2018 The Q… academic… https://a… https:/…    364
 3  2708 E Castronova    Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4   660 RC Cornes, G v… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6  5219 GW Schwert      Why …  1989 The j… Wiley On… https://o… https:/…    560
 7  1701 PR Hansen, A L… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8  2573 LJ Christiano,… The …  2003 inter… Wiley On… https://o… https:/…    586
 9  4813 F Black         Noise  1986 The j… Wiley On… https://o… https:/…    333
10   220 C Binder        Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 988 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;

[[2]]
# A tibble: 980 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1 30964 RF Engle        Auto…  1982 Econo… JSTOR     https://w… https:/…    872
 2  2592 GW Evans, S Ho… Lear…  2012 Learn… degruyte… https://w… https:/…    683
 3   250 O Coibion, Y G… Mone…  2022 Journ… journals… https://w… https:/…     22
 4   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    847
 5   324 P Bordalo, N G… Over…  2020 Ameri… aeaweb.o… https://w… https:/…    518
 6   958 U Malmendier, … Lear…  2016 The Q… academic… https://a… https:/…    114
 7   951 O Coibion, Y G… Info…  2015 Ameri… aeaweb.o… https://w… https:/…    444
 8   247 O Coibion, Y G… Infl…  2020 Journ… Elsevier  https://w… https:/…     28
 9  2823 LEO Svensson    Infl…  1997 Europ… Elsevier  https://w… https:/…     38
10   110 AM Dietrich, K… News…  2022 Journ… Elsevier  https://w… https:/…    667
# ℹ 970 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<p>The outcome is a <strong>list</strong> with 2 elements.</p>
<p>The `purrr` package provides a similar solution, but its going to have its advantages.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 998 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1  3295 GP Compo, JS W… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2   885 E Nakamura, J … High…  2018 The Q… academic… https://a… https:/…    364
 3  2708 E Castronova    Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4   660 RC Cornes, G v… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6  5219 GW Schwert      Why …  1989 The j… Wiley On… https://o… https:/…    560
 7  1701 PR Hansen, A L… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8  2573 LJ Christiano,… The …  2003 inter… Wiley On… https://o… https:/…    586
 9  4813 F Black         Noise  1986 The j… Wiley On… https://o… https:/…    333
10   220 C Binder        Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 988 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;

[[2]]
# A tibble: 980 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1 30964 RF Engle        Auto…  1982 Econo… JSTOR     https://w… https:/…    872
 2  2592 GW Evans, S Ho… Lear…  2012 Learn… degruyte… https://w… https:/…    683
 3   250 O Coibion, Y G… Mone…  2022 Journ… journals… https://w… https:/…     22
 4   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    847
 5   324 P Bordalo, N G… Over…  2020 Ameri… aeaweb.o… https://w… https:/…    518
 6   958 U Malmendier, … Lear…  2016 The Q… academic… https://a… https:/…    114
 7   951 O Coibion, Y G… Info…  2015 Ameri… aeaweb.o… https://w… https:/…    444
 8   247 O Coibion, Y G… Infl…  2020 Journ… Elsevier  https://w… https:/…     28
 9  2823 LEO Svensson    Infl…  1997 Europ… Elsevier  https://w… https:/…     38
10   110 AM Dietrich, K… News…  2022 Journ… Elsevier  https://w… https:/…    667
# ℹ 970 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<p>The result is currently identical 🤷‍♂️. The difference will lie in the fact that while the simplification of <code>lapply</code> is <code>sapply</code>, which only works for vector outputs, the functions belonging to the map function family allow you to explicitly specify the desired output. In this particular case, our output consists of two tables with identical column names. It would be desirable to obtain a single binded table 👊🏻</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,978 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1  3295 GP Compo, JS W… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2   885 E Nakamura, J … High…  2018 The Q… academic… https://a… https:/…    364
 3  2708 E Castronova    Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4   660 RC Cornes, G v… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6  5219 GW Schwert      Why …  1989 The j… Wiley On… https://o… https:/…    560
 7  1701 PR Hansen, A L… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8  2573 LJ Christiano,… The …  2003 inter… Wiley On… https://o… https:/…    586
 9  4813 F Black         Noise  1986 The j… Wiley On… https://o… https:/…    333
10   220 C Binder        Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 1,968 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<p>One emerging issue is that we are unable to determine which observation originates from which file. The <code>map_</code> provides a solution to this as we have an `.id` argument where we can specify the name to be given to the column that stores the id (1, 2, …) of the file. If the input would be a named list or vector, then it will be placed there.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span>, .id <span class="op">=</span> <span class="st">"keyword"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,978 × 27
   keyword Cites Authors Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1 1        3295 GP Com… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2 1         885 E Naka… High…  2018 The Q… academic… https://a… https:/…    364
 3 1        2708 E Cast… Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4 1         660 RC Cor… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5 1         164 MC Med… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6 1        5219 GW Sch… Why …  1989 The j… Wiley On… https://o… https:/…    560
 7 1        1701 PR Han… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8 1        2573 LJ Chr… The …  2003 inter… Wiley On… https://o… https:/…    586
 9 1        4813 F Black Noise  1986 The j… Wiley On… https://o… https:/…    333
10 1         220 C Bind… Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 1,968 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<p>Since the outcome is a tibble we can simple modify this column to replace it with the corresponding file name 📁.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span>, .id <span class="op">=</span> <span class="st">"keyword"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    keyword <span class="op">=</span> <span class="va">file_names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">keyword</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".csv"</span><span class="op">)</span> <span class="co"># remove extension</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,978 × 27
   keyword Cites Authors Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1 daily-…  3295 GP Com… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2 daily-…   885 E Naka… High…  2018 The Q… academic… https://a… https:/…    364
 3 daily-…  2708 E Cast… Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4 daily-…   660 RC Cor… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5 daily-…   164 MC Med… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6 daily-…  5219 GW Sch… Why …  1989 The j… Wiley On… https://o… https:/…    560
 7 daily-…  1701 PR Han… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8 daily-…  2573 LJ Chr… The …  2003 inter… Wiley On… https://o… https:/…    586
 9 daily-…  4813 F Black Noise  1986 The j… Wiley On… https://o… https:/…    333
10 daily-…   220 C Bind… Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 1,968 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<p>Alternative solution:</p>
<p><em>Let’s make a tibble from the <code>file_names</code></em></p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 1
  file_names                                                                    
  &lt;chr&gt;                                                                         
1 /var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/daily-inflation-…
2 /var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/inflation-expect…</code></pre>
</div>
</div>
<p>The primary advantage of the map function is that we can simple use that within the tidy framework we saw last week:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  file_names                                                          data      
  &lt;chr&gt;                                                               &lt;list&gt;    
1 /var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/daily… &lt;spc_tbl_&gt;
2 /var/folders/9f/4hrqlxmn4c3f6mk9hgwqjxmh0000gn/T//RtmpJCrjhi/infla… &lt;spc_tbl_&gt;</code></pre>
</div>
</div>
<p>Yes, these are tibbles within a tibble (madness like “<a href="https://www.youtube.com/watch?v=1U6-eyq04Zg">dream within a dream</a>”) 🥴. The advantage of utilizing the functions provided by tibble and map lies in the fact that, contrary to base R data.frames, tibble-type data.frames can contain a list as a column, enabling the inclusion of any data type within the table. For instance, the file name can be one column (the keywords), all observations can be in the second column, and let’s say the average citation in the third.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span>,</span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".csv"</span><span class="op">)</span> </span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># data column as a vector (list)</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># the first element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 998 × 26
   Cites Authors         Title  Year Source Publisher ArticleURL CitesURL GSRank
   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1  3295 GP Compo, JS W… The …  2011 Quart… Wiley On… https://r… https:/…    875
 2   885 E Nakamura, J … High…  2018 The Q… academic… https://a… https:/…    364
 3  2708 E Castronova    Synt…  2008 Synth… degruyte… https://w… https:/…    498
 4   660 RC Cornes, G v… An e…  2018 Journ… Wiley On… https://a… https:/…    261
 5   164 MC Medeiros, G… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…    122
 6  5219 GW Schwert      Why …  1989 The j… Wiley On… https://o… https:/…    560
 7  1701 PR Hansen, A L… The …  2011 Econo… Wiley On… https://o… https:/…    565
 8  2573 LJ Christiano,… The …  2003 inter… Wiley On… https://o… https:/…    586
 9  4813 F Black         Noise  1986 The j… Wiley On… https://o… https:/…    333
10   220 C Binder        Coro…  2020 Revie… direct.m… https://d… https:/…    504
# ℹ 988 more rows
# ℹ 17 more variables: QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;, ISSN &lt;lgl&gt;,
#   CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span>,</span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>    avg_cite <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Cites</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  file_names                      data                  avg_cite 
  &lt;chr&gt;                           &lt;list&gt;                &lt;list&gt;   
1 daily-inflation-online          &lt;spc_tbl_ [998 × 26]&gt; &lt;dbl [1]&gt;
2 inflation-expectations-forecast &lt;spc_tbl_ [980 × 26]&gt; &lt;dbl [1]&gt;</code></pre>
</div>
</div>
<p>Almost… The 3rd column is now list, although we know that it contains only one number. We can explicitly force to return a dbl vector.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span>,</span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>    avg_cite <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Cites</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co">#&lt;</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  file_names                      data                  avg_cite
  &lt;chr&gt;                           &lt;list&gt;                   &lt;dbl&gt;
1 daily-inflation-online          &lt;spc_tbl_ [998 × 26]&gt;     111.
2 inflation-expectations-forecast &lt;spc_tbl_ [980 × 26]&gt;     165.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
But why do we use the <code>map</code>?
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you refer to a column of the tibble inside a dplyr verb, then the function will take it as a vector by default. For instance, if we use the length function, we would get 2. We have to use map to evaluate the function on the elements of a column one-by-one.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span>,</span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>    l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    l2 <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">length</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  file_names                      data                      l    l2
  &lt;chr&gt;                           &lt;list&gt;                &lt;int&gt; &lt;dbl&gt;
1 daily-inflation-online          &lt;spc_tbl_ [998 × 26]&gt;     2    26
2 inflation-expectations-forecast &lt;spc_tbl_ [980 × 26]&gt;     2    26</code></pre>
</div>
</div>
</div>
</div>
</section><section id="nested-tibbles" class="level2"><h2 class="anchored" data-anchor-id="nested-tibbles">Nested tibbles</h2>
<p>The above seen functionality, that we can store a list as a column of a tibble is great, but what if we need the whole tables as one df. Well, we can simple <code>unnest</code> the columns.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">file_names</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span><span class="op">)</span>,</span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    file_names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>    avg_cite <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Cites</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co">#&lt;</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,978 × 28
   file_names     Cites Authors Title  Year Source Publisher ArticleURL CitesURL
   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;   
 1 daily-inflati…  3295 GP Com… The …  2011 Quart… Wiley On… https://r… https:/…
 2 daily-inflati…   885 E Naka… High…  2018 The Q… academic… https://a… https:/…
 3 daily-inflati…  2708 E Cast… Synt…  2008 Synth… degruyte… https://w… https:/…
 4 daily-inflati…   660 RC Cor… An e…  2018 Journ… Wiley On… https://a… https:/…
 5 daily-inflati…   164 MC Med… Fore…  2021 Journ… Taylor &amp;… https://w… https:/…
 6 daily-inflati…  5219 GW Sch… Why …  1989 The j… Wiley On… https://o… https:/…
 7 daily-inflati…  1701 PR Han… The …  2011 Econo… Wiley On… https://o… https:/…
 8 daily-inflati…  2573 LJ Chr… The …  2003 inter… Wiley On… https://o… https:/…
 9 daily-inflati…  4813 F Black Noise  1986 The j… Wiley On… https://o… https:/…
10 daily-inflati…   220 C Bind… Coro…  2020 Revie… direct.m… https://d… https:/…
# ℹ 1,968 more rows
# ℹ 19 more variables: GSRank &lt;dbl&gt;, QueryDate &lt;dttm&gt;, Type &lt;chr&gt;, DOI &lt;chr&gt;,
#   ISSN &lt;lgl&gt;, CitationURL &lt;lgl&gt;, Volume &lt;lgl&gt;, Issue &lt;lgl&gt;, StartPage &lt;lgl&gt;,
#   EndPage &lt;lgl&gt;, ECC &lt;dbl&gt;, CitesPerYear &lt;dbl&gt;, CitesPerAuthor &lt;dbl&gt;,
#   AuthorCount &lt;dbl&gt;, Age &lt;dbl&gt;, Abstract &lt;chr&gt;, FullTextURL &lt;chr&gt;,
#   RelatedURL &lt;chr&gt;, avg_cite &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may realize that the original unnested columns are copied to each corresponding observation.</p>
</div>
</div>
<p>We can simply use the <code>nest</code> function if we want to achieve the opposite.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span>, .id <span class="op">=</span> <span class="st">"keyword"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    keyword <span class="op">=</span> <span class="va">file_names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">keyword</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".csv"</span><span class="op">)</span> <span class="co"># remove extension</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="op">-</span> <span class="va">keyword</span>, <span class="co"># everything except "keyword" to the "data" column</span></span>
<span>    .by <span class="op">=</span> <span class="va">keyword</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  keyword                         data               
  &lt;chr&gt;                           &lt;list&gt;             
1 daily-inflation-online          &lt;tibble [998 × 26]&gt;
2 inflation-expectations-forecast &lt;tibble [980 × 26]&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span>, .id <span class="op">=</span> <span class="st">"keyword"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    keyword <span class="op">=</span> <span class="va">file_names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">keyword</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".csv"</span><span class="op">)</span> <span class="co"># remove extension</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">keyword</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   keyword [2]
  keyword                         data               
  &lt;chr&gt;                           &lt;list&gt;             
1 daily-inflation-online          &lt;tibble [998 × 26]&gt;
2 inflation-expectations-forecast &lt;tibble [980 × 26]&gt;</code></pre>
</div>
</div>
</section><section id="exercise-1" class="level2"><h2 class="anchored" data-anchor-id="exercise-1">Exercise 1</h2>
<p>Lets open the url of the 5 most cited articles by the 2 topics, which is newer than 10 years, and the abstarct is about the US.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>walk</code> function works similarly like <code>map</code>, but it does not return any value, it is useful if you want to generate side-effects (like opening something in your browser, with the <code>browseURL</code>).</p>
</div>
</div>
<p><em>Solution:</em></p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">file_names</span>, <span class="va">read_csv</span>, .id <span class="op">=</span> <span class="st">"keyword"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    keyword <span class="op">=</span> <span class="va">file_names</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">keyword</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".*/"</span><span class="op">)</span>, <span class="co"># remove the path</span></span>
<span>    keyword <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">keyword</span>, <span class="st">".csv"</span><span class="op">)</span> <span class="co"># remove extension</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">Abstract</span>, <span class="st">" US | USA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">Cites</span>, n <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="va">keyword</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">Cites</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">ArticleURL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">walk</a></span><span class="op">(</span><span class="va">browseURL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exercise-2" class="level2"><h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<p>Let us create a simulation to determine the optimal investment ratio (<span class="math inline">\(f\)</span>) given a probability, (<span class="math inline">\(p\)</span>), of doubling our invested money and a probability of <span class="math inline">\(1-p\)</span> of losing it. We will play this game for a total of 200 rounds. What should be the value of <span class="math inline">\(f\)</span>, given a specific value of <span class="math inline">\(p\)</span>, in order to achieve maximum return?</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">coins</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">p</span> <span class="op">=</span> <span class="fl">.55</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ret</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span> <span class="op">=</span> <span class="fl">.5</span>, <span class="va">f</span> <span class="op">=</span> <span class="fl">.5</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">200</span>, <span class="va">m</span> <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/accumulate.html">accumulate</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="fu">coins</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>    .f <span class="op">=</span> <span class="op">~</span> <span class="op">{</span></span>
<span>      <span class="va">keep</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">.x</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">play</span> <span class="op">=</span> <span class="va">.x</span> <span class="op">-</span> <span class="va">keep</span></span>
<span>      <span class="va">earned</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">keep</span> <span class="op">+</span> <span class="va">play</span> <span class="op">*</span> <span class="va">.y</span><span class="op">)</span></span>
<span>      <span class="co"># message("K:", round(keep), "p", round(play), "x", round(.y, 4), "e", round(earned))</span></span>
<span>      <span class="va">earned</span></span>
<span>    <span class="op">}</span>,</span>
<span>    .init <span class="op">=</span> <span class="va">m</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">.5</span>, to <span class="op">=</span> <span class="fl">.6</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">.7</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">params_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 2
       p      f
   &lt;dbl&gt;  &lt;dbl&gt;
 1   0.5 0     
 2   0.5 0.0778
 3   0.5 0.156 
 4   0.5 0.233 
 5   0.5 0.311 
 6   0.5 0.389 
 7   0.5 0.467 
 8   0.5 0.544 
 9   0.5 0.622 
10   0.5 0.7   
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="cell" data-hash="06-content_cache/html/unnamed-chunk-20_de8f7675e973e80a0badcfc237236d87">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="va">params_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    r <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">f</span>, <span class="op">~</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">last</a></span><span class="op">(</span><span class="fu">ret</span><span class="op">(</span>p <span class="op">=</span> <span class="va">.x</span>, f <span class="op">=</span> <span class="va">.y</span><span class="op">)</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span>, .progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># .progress: show progress line</span></span>
<span>    avg_r <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■                                 3% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■                                7% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■                              10% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■                             13% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■                            17% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■                           20% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■                          23% |  ETA:  2m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■                         27% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■                        30% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■                       33% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■                      37% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■                     40% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■                    43% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■                   47% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■                  50% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■                 53% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■                57% |  ETA:  1m</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■               60% |  ETA: 49s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■              63% |  ETA: 44s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■             67% |  ETA: 40s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■            70% |  ETA: 37s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■           73% |  ETA: 33s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■          77% |  ETA: 29s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■         80% |  ETA: 25s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■        83% |  ETA: 20s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■■       87% |  ETA: 16s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      90% |  ETA: 12s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% |  ETA:  8s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% |  ETA:  4s</code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 4
       p      f r                  avg_r
   &lt;dbl&gt;  &lt;dbl&gt; &lt;list&gt;             &lt;dbl&gt;
 1   0.5 0      &lt;dbl [10,000]&gt; 10000    
 2   0.5 0.0778 &lt;dbl [10,000]&gt; 10483.   
 3   0.5 0.156  &lt;dbl [10,000]&gt;  9619.   
 4   0.5 0.233  &lt;dbl [10,000]&gt; 15987.   
 5   0.5 0.311  &lt;dbl [10,000]&gt;  2677.   
 6   0.5 0.389  &lt;dbl [10,000]&gt;   517.   
 7   0.5 0.467  &lt;dbl [10,000]&gt;  1707.   
 8   0.5 0.544  &lt;dbl [10,000]&gt;     0.319
 9   0.5 0.622  &lt;dbl [10,000]&gt;     0    
10   0.5 0.7    &lt;dbl [10,000]&gt;     0    
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="cell" data-hash="06-content_cache/html/unnamed-chunk-21_f1661db378d3aa59501043514036a4c5">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">r</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">p</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">p</span>, values_from <span class="op">=</span> <span class="va">avg_r</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="op">-</span><span class="va">f</span>, decimals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html">fmt_number</a></span><span class="op">(</span><span class="va">f</span>, decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html">tab_spanner</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/data_color.html">data_color</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ljmoucuwww" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ljmoucuwww table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ljmoucuwww thead, #ljmoucuwww tbody, #ljmoucuwww tfoot, #ljmoucuwww tr, #ljmoucuwww td, #ljmoucuwww th {
  border-style: none;
}

#ljmoucuwww p {
  margin: 0;
  padding: 0;
}

#ljmoucuwww .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ljmoucuwww .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ljmoucuwww .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ljmoucuwww .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ljmoucuwww .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljmoucuwww .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmoucuwww .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljmoucuwww .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ljmoucuwww .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ljmoucuwww .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ljmoucuwww .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ljmoucuwww .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ljmoucuwww .gt_spanner_row {
  border-bottom-style: hidden;
}

#ljmoucuwww .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ljmoucuwww .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ljmoucuwww .gt_from_md > :first-child {
  margin-top: 0;
}

#ljmoucuwww .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ljmoucuwww .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ljmoucuwww .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmoucuwww .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ljmoucuwww .gt_row_group_first td {
  border-top-width: 2px;
}

#ljmoucuwww .gt_row_group_first th {
  border-top-width: 2px;
}

#ljmoucuwww .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmoucuwww .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ljmoucuwww .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ljmoucuwww .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmoucuwww .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmoucuwww .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ljmoucuwww .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ljmoucuwww .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ljmoucuwww .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljmoucuwww .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljmoucuwww .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmoucuwww .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljmoucuwww .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljmoucuwww .gt_left {
  text-align: left;
}

#ljmoucuwww .gt_center {
  text-align: center;
}

#ljmoucuwww .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ljmoucuwww .gt_font_normal {
  font-weight: normal;
}

#ljmoucuwww .gt_font_bold {
  font-weight: bold;
}

#ljmoucuwww .gt_font_italic {
  font-style: italic;
}

#ljmoucuwww .gt_super {
  font-size: 65%;
}

#ljmoucuwww .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ljmoucuwww .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ljmoucuwww .gt_indent_1 {
  text-indent: 5px;
}

#ljmoucuwww .gt_indent_2 {
  text-indent: 10px;
}

#ljmoucuwww .gt_indent_3 {
  text-indent: 15px;
}

#ljmoucuwww .gt_indent_4 {
  text-indent: 20px;
}

#ljmoucuwww .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1" scope="col" id="f">f</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3" scope="colgroup" id="p">
        <span class="gt_column_spanner">p</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="0.50">0.50</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="0.55">0.55</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="0.60">0.60</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="f" class="gt_row gt_right">0.00</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #B3A68A; color: #000000;">10,000</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #0D0606; color: #FFFFFF;">10,000</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">10,000</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.08</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #AEA48F; color: #000000;">10,067</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #271517; color: #FFFFFF;">46,030</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">212,650</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.16</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #9E9E9E; color: #FFFFFF;">10,287</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #A64151; color: #FFFFFF;">210,835</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">4,184,787</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.23</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #61D1E0; color: #000000;">6,046</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #2DAFE6; color: #000000;">919,002</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #060303; color: #FFFFFF;">87,429,495</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.31</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #AEA05E; color: #FFFFFF;">2,259</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #9E9E9E; color: #FFFFFF;">1,936,808</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #3F1E22; color: #FFFFFF;">1,425,716,604</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.39</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #58272E; color: #FFFFFF;">610</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #F2A655; color: #000000;">1,594,350</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #DC5C6A; color: #FFFFFF;">5,149,530,456</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.47</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #0C0506; color: #FFFFFF;">51</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #C88065; color: #FFFFFF;">354,241</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #29E0E5; color: #000000;">19,601,120,279</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.54</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">0</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #2D171A; color: #FFFFFF;">55,296</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #9E9E9E; color: #FFFFFF;">34,492,225,580</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.62</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">0</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">370</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #261516; color: #FFFFFF;">803,305,667</td>
</tr>
<tr>
<td headers="f" class="gt_row gt_right">0.70</td>
<td headers="0.50" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">0</td>
<td headers="0.55" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">0</td>
<td headers="0.60" class="gt_row gt_right" style="background-color: #000000; color: #FFFFFF;">309,720</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Content <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2023 by <a href="https://www.marcellgranat.com">Marcell Granát</a> <br> All content licensed under a <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>